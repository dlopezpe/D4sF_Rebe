{"remainingRequest":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\src\\components\\MapComponent4.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\src\\components\\MapComponent4.vue","mtime":1652784450691},{"path":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\icamon.SMB\\Desktop\\Parcelas\\dataforsmartfarming\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge2dldFByb2ZpbGUsIGdldFBlcm1pc29zfSBmcm9tICdAL2F1dGgvaW5kZXgnDQppbXBvcnQge2dldEFsbEVudGVycHJpc2VzLCBnZXRMYXllcnNGcm9tU2VudGluZWwsIGdldEVudGVycHJpc2V9IGZyb20gJ0AvY3J1ZEZ1bmN0aW9ucy9jcnVkRW50ZXJwcmlzZScvL2dldEVudGVycHJpc2UNCmltcG9ydCB7Z2V0QWxsQ29vcGVyYXRpdmVzLCBnZXRDb29wZXJhdGl2ZX0gZnJvbSAnQC9jcnVkRnVuY3Rpb25zL2NydWRDb29wZXJhdGl2YXMnDQppbXBvcnQgQ29udHJvbGxlclBhbmVsIGZyb20gJ0AvY29tcG9uZW50cy9tYXBDb250cm9sbGVyL0NvbnRyb2xsZXJQYW5lbC52dWUnDQppbXBvcnQgQ29udHJvbGxlclBhbmVsNE1vYmlsZSBmcm9tICdAL2NvbXBvbmVudHMvbWFwQ29udHJvbGxlci9Db250cm9sbGVyUGFuZWw0TW9iaWxlLnZ1ZScNCmltcG9ydCBDb250cm9sbGVyUXVpY2tFZGl0IGZyb20gJ0AvY29tcG9uZW50cy9tYXBDb250cm9sbGVyL0NvbnRyb2xsZXJRdWlja0VkaXQudnVlJw0KaW1wb3J0IENvbnRyb2xsZXJHb29nbGVTZWFyY2ggZnJvbSAnQC9jb21wb25lbnRzL21hcENvbnRyb2xsZXIvQ29udHJvbGxlckdvb2dsZVNlYXJjaC52dWUnDQppbXBvcnQgQ29udHJvbGxlclF1aWNrQ3JlYXRlIGZyb20gJ0AvY29tcG9uZW50cy9tYXBDb250cm9sbGVyL0NvbnRyb2xsZXJRdWlja0NyZWF0ZS52dWUnDQppbXBvcnQge2NoZWNrVmFsaWRQb2x5Z29ufSBmcm9tICdAL2NydWRGdW5jdGlvbnMvY3J1ZEVudGVycHJpc2UnDQppbXBvcnQgcHJvajQgZnJvbSAncHJvajQnDQppbXBvcnQgU3R5bGUgZnJvbSAnb2wvc3R5bGUvU3R5bGUnDQppbXBvcnQgVGV4dCBmcm9tICdvbC9zdHlsZS9UZXh0Jw0KaW1wb3J0IEZpbGwgZnJvbSAnb2wvc3R5bGUvRmlsbCcNCmltcG9ydCBTdHJva2UgZnJvbSAnb2wvc3R5bGUvU3Ryb2tlJw0KaW1wb3J0IEwgZnJvbSAnbGVhZmxldCcNCmltcG9ydCB7IGdldEFyZWEgfSBmcm9tICdvbC9zcGhlcmUnOw0KaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJw0KLy9pbXBvcnQgUG9seWdvbiBmcm9tICdvbC9nZW9tL1BvbHlnb24nDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ01hcENvbXBvbmVudDQnLA0KICAgIGNvbXBvbmVudHM6IHtDb250cm9sbGVyUGFuZWwsIENvbnRyb2xsZXJRdWlja0VkaXQsIENvbnRyb2xsZXJHb29nbGVTZWFyY2gsQ29udHJvbGxlclBhbmVsNE1vYmlsZSwgQ29udHJvbGxlclF1aWNrQ3JlYXRlDQogICAgfSwNCiAgICBkYXRhKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZmxhZ0luZGljYXRpbmdEYXRhSGFzQmVlbkxvYWRlZEluVmFyaWFibGVzOiBmYWxzZSwNCiAgICAgICAgICAgIC8vVXN1YXJpbw0KICAgICAgICAgICAgaXNfc3VwZXJ1c2VyOiBmYWxzZSwNCiAgICAgICAgICAgIGlzX3N0YWZmOiBmYWxzZSwNCiAgICAgICAgICAgIGlzX3N5c3RlbWFkbWluOiBmYWxzZSwNCiAgICAgICAgICAgIGlzX2VudGVycHJpc2VhZG1pbjogZmFsc2UsDQogICAgICAgICAgICBpc19jb29wX3VzZXI6IGZhbHNlLA0KICAgICAgICAgICAgLy9CaW5nTWFwDQogICAgICAgICAgICBhcGlLZXlCaW5nOiB0aGlzLiRhcGlLZXlCaW5nLA0KICAgICAgICAgICAgaW1hZ2VyeVNldEJpbmc6IGBBZXJpYWxXaXRoTGFiZWxzYCwNCiAgICAgICAgICAgIHpvb206IDE1LA0KICAgICAgICAgICAgY2VudGVyOiBbLTMuODIyNTk3MDk1NDg0MTQ4NiwgNDAuMjgzODUwNzQyNDQ5NzcgXSwNCiAgICAgICAgICAgIG1heFpvb21CaW5nOiAyMCwNCiAgICAgICAgICAgIGlzQWN0aXZlTG9hZGluZzogZmFsc2UsDQogICAgICAgICAgICBpc1Zpc2libGVMb2FkOiBmYWxzZSwNCiAgICAgICAgICAgIG5hbWU6ICdwcnVlYmFzJywNCiAgICAgICAgICAgIC8vUGFyY2VsYXMNCiAgICAgICAgICAgIHBhcmNlbGFzOiB7fSwNCiAgICAgICAgICAgIC8vRW1wcmVzYXMgc2VsDQogICAgICAgICAgICBhcnJFbXByZXNhczogW10sDQogICAgICAgICAgICBhcnJDb29wZXJhdGl2YXM6IFtdLA0KICAgICAgICAgICAgYXJyRW1wcmVzYXM0TGlzdDogW10sDQogICAgICAgICAgICAvL1NlbnRpbmVsIGxheWVyIHRpbGUgY29udHJvbGxlcg0KICAgICAgICAgICAgdXJsU2VudGluZWw6IGAke3RoaXMuJHNlbnRpbmVsVVJMfS9vZ2Mvd21zL2AsDQogICAgICAgICAgICBtaW5ab29tOjYsDQogICAgICAgICAgICBtYXhab29tOjE2LA0KICAgICAgICAgICAgcHJlc2V0OidBR1JJQ1VMVFVSRScsDQogICAgICAgICAgICBsYXllcnM6J0FHUklDVUxUVVJFJywNCiAgICAgICAgICAgIHRpbWU6YDIwMTktMDEtMDEvJHt0aGlzLmdldE5vdygpfWAsDQogICAgICAgICAgICBzZXJ2ZXJUeXBlOiAnZ2Vvc2VydmVyJywNCiAgICAgICAgICAgIG9wYWNpdHlsYXllcjogMC41LA0KICAgICAgICAgICAgdHJhbnNpdGlvbjogMCwNCiAgICAgICAgICAgIFNlbnRpbmVsTGF5ZXI6ICdBR1JJQ1VMVFVSRScsDQogICAgICAgICAgICB0aW1lc3RhbXA6IDAsDQogICAgICAgICAgICB0aW1lc3RhbXBTZW50aW5lbDogMCwNCiAgICAgICAgICAgIHRpbWVzdGFtcERyYXdQb2x5Z29uOiAwLA0KICAgICAgICAgICAgY2hlY2tlZFRvZ2dsZU1vc3RhclRleHRvOiBmYWxzZSwNCiAgICAgICAgICAgIGxheWVyc1NlbGVjdG9yOiBbXSwNCiAgICAgICAgICAgIC8vTW9kaWZpY2FyUGFyY2VsYQ0KICAgICAgICAgICAga2V5TW9kaWZpY2FyOiAwLA0KICAgICAgICAgICAgYWxsUGFyY2Vsc09mRW50ZXJwcmlzZXM6IFtdLA0KICAgICAgICAgICAgYWxsUGFyY2Vsc09mRW50ZXJwcmlzZXNGaWx0ZXI6IFtdLA0KICAgICAgICAgICAgLy9pZg0KICAgICAgICAgICAgaWZRdWlja0VkaXQ6IGZhbHNlLA0KICAgICAgICAgICAgLy8NCiAgICAgICAgICAgIHBhcmNlbFNlbGVjdGVkOiBPYmplY3QsDQogICAgICAgICAgICB2ZXJFcnJvckRyYXc6IGZhbHNlLA0KICAgICAgICAgICAgZXJyb3JEcmF3TXNnOiAnJywNCiAgICAgICAgICAgIGNvb3JkaW5hdGVzUG9seTogJycsDQogICAgICAgICAgICAvL0NyZWFyIFBhcmNlbGENCiAgICAgICAgICAgIGZlYXR1cmVzTmV3UG9seWdvbjogW10sDQogICAgICAgICAgICB2ZXJDcmVhclBhcmNlbDogdHJ1ZSwNCiAgICAgICAgICAgIHZlckNyZWFyUGFyY2VsRHJhdzogZmFsc2UsDQogICAgICAgICAgICBlbXByZXNhU2VsRm9yQ3JlYXRlUGFyY2VsOiAnJywNCiAgICAgICAgICAgIHJlZnJlc2hEaWJ1am86IDAsDQogICAgICAgICAgICAvL2VkaXRhclBhcmNlbA0KICAgICAgICAgICAgdmFsdWVEZXNjOiAnJywNCiAgICAgICAgICAgIHZhbHVlTmFtZTogJycsDQogICAgICAgICAgICBhcmVhRm9yTmV3UG9seWdvbjogMCwNCiAgICAgICAgICAgIC8vDQogICAgICAgICAgICB1c2VyOiAnJywNCiAgICAgICAgICAgIGNvb3JkZW5hZGFzUHVudG86IFswLCAwXSwNCiAgICAgICAgICAgIG9sY3VsdGFySW5jb25vVWJpOiBmYWxzZQ0KICAgICAgICB9DQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIGlzTW9iaWxlKCkgew0KICAgICAgICAgICAgaWYoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGdldE5vd1NlbnRpbmVsKCkgew0KICAgICAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgY29uc3QgZGF0ZSA9IHRvZGF5LmdldEZ1bGxZZWFyKCkrJy0nKyh0b2RheS5nZXRNb250aCgpKzEpKyctJyt0b2RheS5nZXREYXRlKCk7DQogICAgICAgICAgICBjb25zdCB0aW1lID0gdG9kYXkuZ2V0SG91cnMoKSArICI6IiArIHRvZGF5LmdldE1pbnV0ZXMoKSArICI6IiArIHRvZGF5LmdldFNlY29uZHMoKTsNCiAgICAgICAgICAgIGNvbnN0IGRhdGVUaW1lID0gZGF0ZSArJyAnKyB0aW1lOw0KICAgICAgICAgICAgdGhpcy50aW1lc3RhbXBTZW50aW5lbCA9IGRhdGVUaW1lOw0KICAgICAgICB9LA0KICAgICAgICBnZXROb3dSZWZyZXNoRHJhd1BvbHlnb24oKSB7DQogICAgICAgICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICBjb25zdCBkYXRlID0gdG9kYXkuZ2V0RnVsbFllYXIoKSsnLScrKHRvZGF5LmdldE1vbnRoKCkrMSkrJy0nK3RvZGF5LmdldERhdGUoKTsNCiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSB0b2RheS5nZXRIb3VycygpICsgIjoiICsgdG9kYXkuZ2V0TWludXRlcygpICsgIjoiICsgdG9kYXkuZ2V0U2Vjb25kcygpOw0KICAgICAgICAgICAgY29uc3QgZGF0ZVRpbWUgPSBkYXRlICsnICcrIHRpbWU7DQogICAgICAgICAgICB0aGlzLnRpbWVzdGFtcERyYXdQb2x5Z29uID0gZGF0ZVRpbWU7DQogICAgICAgIH0sDQogICAgICAgIGdldE5vdygpIHsNCiAgICAgICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSB0b2RheS5nZXRGdWxsWWVhcigpKyctJysodG9kYXkuZ2V0TW9udGgoKSsxKSsnLScrdG9kYXkuZ2V0RGF0ZSgpOw0KICAgICAgICAgICAgY29uc3QgdGltZSA9IHRvZGF5LmdldEhvdXJzKCkgKyAiOiIgKyB0b2RheS5nZXRNaW51dGVzKCkgKyAiOiIgKyB0b2RheS5nZXRTZWNvbmRzKCk7DQogICAgICAgICAgICBjb25zdCBkYXRlVGltZSA9IGRhdGUgKycgJysgdGltZTsNCiAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gZGF0ZVRpbWU7DQogICAgICAgIH0sDQogICAgICAgIHBvaW50c1N0eWxlRnVuYygpew0KICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmUgPT4gew0KICAgICAgICAgICAgICAgIGxldCBiYXNlU3R5bGUgPSBuZXcgU3R5bGUoew0KICAgICAgICAgICAgICAgICAgICBmaWxsOiBuZXcgRmlsbCh7DQogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogInJnYmEoMjU1LDI1NSwyNTUsMC4wKSIsDQogICAgICAgICAgICAgICAgICAgIH0pLA0KICAgICAgICAgICAgICAgICAgICBzdHJva2U6IG5ldyBTdHJva2Uoew0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICJyZ2JhKDAsIDAsIDI1NSwgMSkiLA0KICAgICAgICAgICAgICAgICAgICAgICAgd2l0aDogNQ0KICAgICAgICAgICAgICAgICAgICB9KSwNCiAgICAgICAgICAgICAgICAgICAgdGV4dDogbmV3IFRleHQoew0KICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6IHRoaXMuY2hlY2tlZFRvZ2dsZU1vc3RhclRleHRvLA0KICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogYCR7ZmVhdHVyZS5nZXQoJ25hbWUnKX0gXG4gJHtmZWF0dXJlLmdldCgnZGVzY3JpcHRpb24nKSA/IGZlYXR1cmUuZ2V0KCdkZXNjcmlwdGlvbicpIDogJyd9IFxuICR7ZmVhdHVyZS5nZXQoJ2FyZWEnKSA/IGZlYXR1cmUuZ2V0KCdhcmVhJykudG9GaXhlZCgyKSsnSGEnIDogJycgfSAvICR7ZmVhdHVyZS5nZXQoJ2FyZWEnKSA/IHRoaXMubWV0cmljYXBhcmNlbGEoZmVhdHVyZS5nZXQoJ2FyZWEnKSkrJ0FjcmUnIDogJycgfWAsDQogICAgICAgICAgICAgICAgICAgICAgICBmb250OiAiMTRweCBJQk0gUGxleCBTYW5zIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGw6IG5ldyBGaWxsKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbG9yOiAiIzE2MTYxNiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICIjRkZGRkZGIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogIiMxNjE2MTYiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiA0LjUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLA0KICAgICAgICAgICAgICAgICAgICB9KSwNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIHJldHVybiBbDQogICAgICAgICAgICAgICAgICAgIGJhc2VTdHlsZSwNCiAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIG1ldHJpY2FwYXJjZWxhKGFyZWEpew0KICAgICAgICAgICAgY29uc3Qgb25laGVjdHRvQWNyZSA9IDIuNDcxMDUzODE0NjcxNw0KICAgICAgICAgICAgY29uc3QgYWNyZSA9IG9uZWhlY3R0b0FjcmUgKiBhcmVhDQogICAgICAgICAgICB0aGlzLm1ldHJpYyA9ICJBY3JlIg0KICAgICAgICAgICAgcmV0dXJuICBhY3JlLnRvRml4ZWQoMikNCiAgICAgICAgDQogICAgICAgIH0sDQoNCiAgICAgICAgc2VsZWNpb25hUG9seWdvbihwbyl7DQogICAgICAgICAgICB0aGlzLmlmUXVpY2tFZGl0ID0gdHJ1ZQ0KICAgICAgICAgICAgdGhpcy5jb29yZGluYXRlc1BvbHkgPSAnJw0KICAgICAgICAgICAgdGhpcy52ZXJFcnJvckRyYXcgPSB0cnVlDQogICAgICAgICAgICB0aGlzLnZlckVycm9yRHJhdyA9IHRydWUNCiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuYWxsUGFyY2Vsc09mRW50ZXJwcmlzZXMuZmlsdGVyKHBhcmNlbCA9PiBwYXJjZWwuaWQgPT0gcG8uaWRfKQ0KICAgICAgICAgICAgdGhpcy5wYXJjZWxTZWxlY3RlZCA9IHJlc3VsdFswXQ0KICAgICAgICAgICAgY29uc3QgY29vcmRlbmFkYXNHZW9tZXRyaWNhcyA9IHBvLmdldEdlb21ldHJ5KCkuZ2V0RXh0ZW50KCkNCiAgICAgICAgICAgIGNvbnN0IGV4ID0gY29vcmRlbmFkYXNHZW9tZXRyaWNhc1swXSArIChjb29yZGVuYWRhc0dlb21ldHJpY2FzWzJdLWNvb3JkZW5hZGFzR2VvbWV0cmljYXNbMF0pLzI7DQogICAgICAgICAgICBjb25zdCB5ZSA9IGNvb3JkZW5hZGFzR2VvbWV0cmljYXNbMV0gKyAoY29vcmRlbmFkYXNHZW9tZXRyaWNhc1szXS1jb29yZGVuYWRhc0dlb21ldHJpY2FzWzFdKS8yOw0KICAgICAgICAgICAgdmFyIHNvdXJjZSA9IG5ldyBwcm9qNC5Qcm9qKCdFUFNHOjM3ODUnKTsgDQogICAgICAgICAgICB2YXIgZGVzdCA9IG5ldyBwcm9qNC5Qcm9qKCdFUFNHOjQzMjYnKTsgIA0KICAgICAgICAgICAgY29uc3QgbmV3Q2VudGVyID0gcHJvajQoc291cmNlLCBkZXN0LCBbZXgsIHllXSkNCiAgICAgICAgICAgIHRoaXMuY2VudGVyID0gW25ld0NlbnRlclswXSwgbmV3Q2VudGVyWzFdXQ0KICAgICAgICAgICAgY29uc3QgZW50ZXJwcmlzZV9pZCA9IHBvLnZhbHVlc18uZW50ZXJwcmlzZV9pZA0KICAgICAgICAgICAgdGhpcy52YWx1ZU5hbWUgPSBwby52YWx1ZXNfLm5hbWUNCiAgICAgICAgICAgIHRoaXMudmFsdWVEZXNjID0gcG8udmFsdWVzXy5kZXNjcmlwdGlvbg0KICAgICAgICAgICAgdGhpcy5jb21wcm9iYXJDb29yZGVuYWRhcyhwby5nZXRHZW9tZXRyeSgpLmdldENvb3JkaW5hdGVzKCksIGVudGVycHJpc2VfaWQsIHBvLmlkXykNCiAgICAgICAgfSwNCiAgICAgICAgdGVybWluYWRvTmV3UG9seWdvbihwKXsNCiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhwKQ0KICAgICAgICAgICAgdGhpcy52ZXJDcmVhclBhcmNlbERyYXcgPSB0cnVlDQogICAgICAgICAgICB0aGlzLmFyZWFGb3JOZXdQb2x5Z29uID0gKE1hdGgucm91bmQoKGdldEFyZWEocC5mZWF0dXJlLmdldEdlb21ldHJ5KCkpLyAxMDAwMCkgKiAxMDAwMCkgLyAxMDAwMCkNCiAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzRWRpdGFkYXMgPSBwLmZlYXR1cmUuZ2V0R2VvbWV0cnkoKS5nZXRDb29yZGluYXRlcygpDQogICAgICAgICAgICB0aGlzLmNvbXByb2JhckNvb3JkZW5hZGFzKGNvb3JkaW5hdGVzRWRpdGFkYXMsICh0aGlzLmVtcHJlc2FTZWxGb3JDcmVhdGVQYXJjZWwgPyB0aGlzLmVtcHJlc2FTZWxGb3JDcmVhdGVQYXJjZWxbMF0uaWQgOiB0aGlzLmFyckVtcHJlc2FzWzBdLmlkKSwgMCkNCiAgICAgICAgfSwNCiAgICAgICAgZWRpdGFkbyhwKXsNCiAgICAgICAgICAgIGNvbnN0IGVudGVycHJpc2VfaWQgPSBwLmZlYXR1cmVzLmFycmF5X1swXS52YWx1ZXNfLmVudGVycHJpc2VfaWQNCiAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzRWRpdGFkYXMgPSBwLmZlYXR1cmVzLmFycmF5X1swXS5nZXRHZW9tZXRyeSgpLmdldENvb3JkaW5hdGVzKCkNCiAgICAgICAgICAgIHRoaXMuYXJlYUZvck5ld1BvbHlnb24gPSAoTWF0aC5yb3VuZCgoZ2V0QXJlYShwLmZlYXR1cmVzLmFycmF5X1swXS5nZXRHZW9tZXRyeSgpKS8gMTAwMDApICogMTAwMDApIC8gMTAwMDApDQogICAgICAgICAgICAvL2NvbnN0IGFyZWEgPSAoTWF0aC5yb3VuZCgoZ2V0QXJlYShwLmZlYXR1cmVzLmFycmF5X1swXS5nZXRHZW9tZXRyeSgpKSAvIDEwMDAwKSAqIDEwMDAwKSAvIDEwMDAwKQ0KICAgICAgICAgICAgdGhpcy5jb21wcm9iYXJDb29yZGVuYWRhcyhjb29yZGluYXRlc0VkaXRhZGFzLCBlbnRlcnByaXNlX2lkLCBwLmZlYXR1cmVzLmFycmF5X1swXS5pZF8pDQogICAgICAgICAgICAvL2lmKHRoaXMucGFyY2VsYVNlbGVjY2lvbmFkYSl7DQogICAgICAgICAgICAgICAgLy90aGlzLmNvb3JkaW5hdGVzQnVlbmFzKHRoaXMuY29vcmRpbmF0ZXNFZGl0YWRhcykNCiAgICAgICAgICAgIC8vfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvL3RoaXMudmVyRXJyb3JEcmF3ID0gZmFsc2UNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0QkJPWChwYXJjZWwpew0KICAgICAgICAgICAgY29uc3QgcG9seWdvbiA9IEwucG9seWdvbihwYXJjZWwuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpDQoNCiAgICAgICAgICAgIGNvbnN0IGJib3hQID0gYCR7cG9seWdvbi5nZXRCb3VuZHMoKS5fbm9ydGhFYXN0LmxuZ30sJHtwb2x5Z29uLmdldEJvdW5kcygpLl9ub3J0aEVhc3QubGF0fSwke3BvbHlnb24uZ2V0Qm91bmRzKCkuX3NvdXRoV2VzdC5sbmd9LCR7cG9seWdvbi5nZXRCb3VuZHMoKS5fc291dGhXZXN0LmxhdH1gDQogICAgICAgICAgICByZXR1cm4gYmJveFANCiAgICAgICAgfSwNCiAgICAgICAgZ2V0QkJPWDIocGFyY2VsKXsNCiAgICAgICAgICAgIGNvbnN0IHBvbHlnb24gPSBMLnBvbHlnb24ocGFyY2VsLmdlb21ldHJ5LmNvb3JkaW5hdGVzKQ0KDQogICAgICAgICAgICBjb25zdCBiYm94UCA9IFtwb2x5Z29uLmdldEJvdW5kcygpLl9ub3J0aEVhc3QubG5nLHBvbHlnb24uZ2V0Qm91bmRzKCkuX25vcnRoRWFzdC5sYXQscG9seWdvbi5nZXRCb3VuZHMoKS5fc291dGhXZXN0LmxuZyxwb2x5Z29uLmdldEJvdW5kcygpLl9zb3V0aFdlc3QubGF0XQ0KICAgICAgICAgICAgcmV0dXJuIGJib3hQDQogICAgICAgIH0sDQogICAgICAgIGNvbXByb2JhckNvb3JkZW5hZGFzKGNvb3JkcywgZW50ZXJwcmlzZSwgaWRQYXJjZWxhKXsNCiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBuZXcgcHJvajQuUHJvaignRVBTRzozNzg1Jyk7IA0KICAgICAgICAgICAgdmFyIGRlc3QgPSBuZXcgcHJvajQuUHJvaignRVBTRzo0MzI2Jyk7IA0KICAgICAgICAgICAgbGV0IG5ld0NlbnRlciA9IEFycmF5Ow0KICAgICAgICAgICAgbGV0IHBvbHlnb25PYmplY3Q9ICdQT0xZR09OKCgnDQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb3Jkc1swXS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIG5ld0NlbnRlciA9IHByb2o0KHNvdXJjZSwgZGVzdCwgW2Nvb3Jkc1swXVtpXVswXSwgY29vcmRzWzBdW2ldWzFdXSkNCiAgICAgICAgICAgICAgICBwb2x5Z29uT2JqZWN0ICs9IG5ld0NlbnRlclswXSsnICcrbmV3Q2VudGVyWzFdDQogICAgICAgICAgICAgICAgaWYoaSAhPSAoY29vcmRzWzBdLmxlbmd0aC0xKSl7DQogICAgICAgICAgICAgICAgICAgIHBvbHlnb25PYmplY3QgKz0gJywgJw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHBvbHlnb25PYmplY3QgKz0gJykpJzsNCg0KICAgICAgICAgICAgY2hlY2tWYWxpZFBvbHlnb24ocG9seWdvbk9iamVjdCwgZW50ZXJwcmlzZSkNCiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLmZlYXR1cmVzLmxlbmd0aCl7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHJlc3BvbnNlLmRhdGEuZmVhdHVyZXMuZmlsdGVyKGZlYXR1cmUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoZmVhdHVyZS5pZCAhPSBpZFBhcmNlbGEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmZWF0dXJlDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdC5sZW5ndGgpew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmNlbHNOYW1lID0gJycNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5tYXAocmVzdWx0YWRvID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJjZWxzTmFtZSArPSByZXN1bHRhZG8ucHJvcGVydGllcy5uYW1lICsgJyAnDQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvckRyYXdNc2cgPSB0aGlzLiR0KCdtYXAucGFyY2VsYV9zb2xhcGFkYV9jb24nKSArICcnICsgcGFyY2Vsc05hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmVyRXJyb3JEcmF3ID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb29yZGluYXRlc1BvbHkgPSAnJw0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmVyRXJyb3JEcmF3ID0gZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JEcmF3TXNnID0gJycNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29vcmRpbmF0ZXNQb2x5ID0gcG9seWdvbk9iamVjdA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcnVlYmFQYXJjZWxhU2ltcGxlKHBvbHlnb25PYmplY3QpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJFcnJvckRyYXcgPSBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yRHJhd01zZyA9ICcnDQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29vcmRpbmF0ZXNQb2x5ID0gcG9seWdvbk9iamVjdA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBydWViYVBhcmNlbGFTaW1wbGUocG9seWdvbk9iamVjdCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KICAgICAgICBjb21wcnVlYmFQYXJjZWxhU2ltcGxlKHBvbHlnb25PYmplY3Qpew0KICAgICAgICAgICAgbGV0IHBhdGggPSBgJHt0aGlzLiRhcGlVUkx9L3BhcmNlbF92YWxpZC8/cG9seWdvbj0ke3BvbHlnb25PYmplY3R9YDsNCiAgICAgICAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydBdXRob3JpemF0aW9uJ10gPSAiQmVhcmVyICIrc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiYXBpQWNjZXNzIikNCiAgICAgICAgICAgIGF4aW9zDQogICAgICAgICAgICAuZ2V0KHBhdGgpDQogICAgICAgICAgICAudGhlbihyZXNwb25zZT0+ew0KICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEgPT0gIkZhbHNlIil7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JEcmF3TXNnID0gdGhpcy4kdCgnbWFwLnBhcmNlbGFfc29sYXBhZGFfbWlzbWEnKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZlckVycm9yRHJhdyA9IHRydWUNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJFcnJvckRyYXcgPSBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yRHJhd01zZyA9ICcnDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGVycm9yKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSwNCiAgICB9LA0KICAgIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgDQogICAgICAgIC8vY29uc29sZS5pbmZvKCdVc2VyIExvZ2dlZCcpDQogICAgfSwNCiAgICBiZWZvcmVDcmVhdGUoKXsNCiAgICAgICAgdGhpcy5pc0FjdGl2ZUxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB0aGlzLmlzVmlzaWJsZUxvYWQgPSBmYWxzZQ0KICAgICAgICAvLyogMSAtIE9idGVuZW1vcyBsYSBpbmZvIGRlbCB1c3VhcmlvLCBhIHF1ZSBlbXByZXNhIHBlcnRlbmVjZSB5IHNpIGVzIGFkbWluaXN0cmFkb3INCiAgICAgICAgZ2V0UHJvZmlsZSgpDQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXNwb25zZS5kYXRhWzBdDQogICAgICAgICAgICBjb25zb2xlLmluZm8odXNlcikNCiAgICAgICAgICAgIHRoaXMudXNlciA9IHVzZXINCiAgICAgICAgICAgIGdldFBlcm1pc29zKHJlc3BvbnNlLmRhdGFbMF0udXNlcikNCiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzX3N1cGVydXNlciA9IHJlc3BvbnNlLmRhdGEuaXNfc3VwZXJ1c2VyDQogICAgICAgICAgICAgICAgdGhpcy5pc19zdGFmZiA9IHJlc3BvbnNlLmRhdGEuaXNfc3RhZmYNCiAgICAgICAgICAgICAgICB0aGlzLmlzX3N5c3RlbWFkbWluID0gcmVzcG9uc2UuZGF0YS5pc19zeXN0ZW1hZG1pbg0KICAgICAgICAgICAgICAgIHRoaXMuaXNfZW50ZXJwcmlzZWFkbWluID0gcmVzcG9uc2UuZGF0YS5pc19lbnRlcnByaXNlYWRtaW4NCiAgICAgICAgICAgICAgICB0aGlzLmlzX2Nvb3BfdXNlciA9IHVzZXIuY29vcGVyYXRpdmVfdXNlcg0KICAgICAgICAgICAgICAgIC8qDQogICAgICAgICAgICAgICAgLy8qT2J0ZW5lbW9zIGxhIGVtcHJlc2EgZGVsIHVzdWFyaW8NCiAgICAgICAgICAgICAgICBjb25zdCBlbnRlcnByaXNlX2lkID0gdXNlci5lbnRlcnByaXNlX2lkDQogICAgICAgICAgICAgICAgZ2V0RW50ZXJwcmlzZShlbnRlcnByaXNlX2lkKQ0KICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jIHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJjZWxhcyA9IHJlc3BvbnNlLmRhdGEucGFyY2Vscw0KICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFyckVtcHJlc2FzLnB1c2gocmVzcG9uc2UuZGF0YSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mbGFnSW5kaWNhdGluZ0RhdGFIYXNCZWVuTG9hZGVkSW5WYXJpYWJsZXMgPSBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVzdGFtcCgpDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmKHRoaXMuaXNfc3VwZXJ1c2VyIHx8IHRoaXMuaXNfc3lzdGVtYWRtaW4pew0KICAgICAgICAgICAgICAgICAgICBnZXRBbGxFbnRlcnByaXNlcygpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jIHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXJyRW1wcmVzYXMgPSBbcmVzcG9uc2UuZGF0YVswXV0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXJyRW1wcmVzYXM0TGlzdCA9IHJlc3BvbnNlLmRhdGENCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFyclBhcmNlbHMgPSBbXQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy9jYXJnYSBkZSBsYSBwcmltZXJhIGVtcHJlc2ENCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVtcHJlc2FGaXJzdCA9IFtyZXNwb25zZS5kYXRhWzBdXQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy9yZXNwb25zZS5kYXRhWzBdLm1hcChlbnRlcnByaXNlID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVtcHJlc2FGaXJzdC5tYXAoZW50ZXJwcmlzZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50ZXJwcmlzZS5wYXJjZWxzLmZlYXR1cmVzLm1hcChwYXJjZWwgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJQYXJjZWxzLnB1c2gocGFyY2VsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGxQYXJjZWxzT2ZFbnRlcnByaXNlcyA9IGFyclBhcmNlbHMNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsUGFyY2Vsc09mRW50ZXJwcmlzZXNGaWx0ZXIgPSBhcnJQYXJjZWxzDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZsYWdJbmRpY2F0aW5nRGF0YUhhc0JlZW5Mb2FkZWRJblZhcmlhYmxlcyA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9ZWxzZSBpZigodGhpcy5pc19lbnRlcnByaXNlYWRtaW4gfHwgdGhpcy5pc19zdGFmZikgJiYgIXRoaXMuaXNfY29vcF91c2VyKXsgDQogICAgICAgICAgICAgICAgICAgIGdldEVudGVycHJpc2UodXNlci5lbnRlcnByaXNlX2lkKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbihhc3luYyByZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFyckVtcHJlc2FzID0gW3Jlc3BvbnNlLmRhdGFdDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFyckVtcHJlc2FzNExpc3QgPSBbcmVzcG9uc2UuZGF0YV0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFyclBhcmNlbHMgPSBbXQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5wYXJjZWxzLmZlYXR1cmVzLm1hcChwYXJjZWwgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyclBhcmNlbHMucHVzaChwYXJjZWwpDQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGxQYXJjZWxzT2ZFbnRlcnByaXNlcyA9IGFyclBhcmNlbHMNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsUGFyY2Vsc09mRW50ZXJwcmlzZXNGaWx0ZXIgPSBhcnJQYXJjZWxzDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZsYWdJbmRpY2F0aW5nRGF0YUhhc0JlZW5Mb2FkZWRJblZhcmlhYmxlcyA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9ZWxzZSBpZih0aGlzLmlzX2Nvb3BfdXNlcil7DQogICAgICAgICAgICAgICAgICAgIGdldENvb3BlcmF0aXZlKHVzZXIuZW50ZXJwcmlzZV9pZCkNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcnJDb29wZXJhdGl2YXMgPSBbcmVzcG9uc2UuZGF0YV0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5hcnJFbXByZXNhcyA9IHJlc3BvbnNlLmRhdGEuZW50ZXJwcmlzZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmxhZ0luZGljYXRpbmdEYXRhSGFzQmVlbkxvYWRlZEluVmFyaWFibGVzID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmKHRoaXMuaXNfc3VwZXJ1c2VyIHx8IHRoaXMuaXNfc3lzdGVtYWRtaW4pew0KICAgICAgICAgICAgICAgICAgICBnZXRBbGxDb29wZXJhdGl2ZXMoKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbihhc3luYyByZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFyckNvb3BlcmF0aXZhcyA9IHJlc3BvbnNlLmRhdGENCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5pc0FjdGl2ZUxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlTG9hZCA9IGZhbHNlDQogICAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgICAgICBnZXRMYXllcnNGcm9tU2VudGluZWwoKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIHRoaXMubGF5ZXJzU2VsZWN0b3IgPSByZXNwb25zZS5kYXRhDQogICAgICAgIH0pDQogICAgfQ0KfQ0K"},{"version":3,"sources":["MapComponent4.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MapComponent4.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div>\r\n        <cv-loading\r\n            :small=\"true\"\r\n            :active=\"true\"\r\n            :overlay=\"false\" v-if=\"true\" id=\"cargando\"></cv-loading>\r\n        <vl-map\r\n            :load-tiles-while-animating=\"false\"\r\n            :load-tiles-while-interacting=\"false\"\r\n            data-projection=\"EPSG:4326\"\r\n            style=\"height: 400px\"\r\n            id=\"map\"\r\n            class=\"mapa\"\r\n            ref=\"map\"\r\n            \r\n        >\r\n            <vl-view :zoom.sync=\"zoom\" :center=\"center\"></vl-view> \r\n            \r\n            \r\n\r\n            \r\n            <vl-layer-tile :id=\"`wmts_${enterprise.id}`\" :opacity=\"opacitylayer\" v-bind:key=\"`${enterprise.id}_layers_${timestampSentinel}`\" v-for=\"enterprise in arrEmpresas\" :z-index=\"2\">\r\n                <vl-source-wms\r\n                    v-if=\"enterprise.parcels.features.length\"\r\n                    :key=\"`${enterprise.id}_${timestampSentinel}`\" \r\n                    :url=\"`${urlSentinel}${enterprise.sentinel_instance}/?MAXCC=100&v=${timestampSentinel}&`\"\r\n                    :urlProcessingApi=\"`${urlSentinel}${enterprise.sentinel_instance}/?MAXCC=100&&v=${timestampSentinel}&`\"\r\n                    maxcc=\"100\"\r\n                    :minZoom=\"minZoom\"\r\n                    :maxZoom=\"maxZoom\"\r\n                    :preset=\"preset\"\r\n                    :layers=\"SentinelLayer\"\r\n                    :time.sync=\"time\"\r\n                    :serverType=\"serverType\"\r\n                    :opacity=\"opacitylayer\"\r\n                    :transition='transition'\r\n                    :tiled = false\r\n                />\r\n            </vl-layer-tile>\r\n            \r\n            <vl-layer-vector v-for=\"enterprise in arrEmpresas\" v-bind:key=\"`${enterprise.id}_1_${timestamp}`\" :z-index=\"3\">\r\n                <vl-source-vector ref=\"drawTarget\" v-if=\"enterprise.parcels\" :features=\"enterprise.parcels.features\" />\r\n                <vl-style-func :factory=\"pointsStyleFunc\" />\r\n            </vl-layer-vector>\r\n            \r\n            <vl-interaction-select v-if=\"verCrearParcel\" :id=\"`modify_target_${timestamp}`\" ref=\"selectInteraction\" ident=\"modify-target\" @select=\"selecionaPolygon\" :key=\"timestampSentinel\"></vl-interaction-select>\r\n            <vl-interaction-modify v-if=\"verCrearParcel\" source=\"modify-target\" @modifyend=\"editado\"></vl-interaction-modify>\r\n            \r\n            <vl-layer-vector :z-index=\"4\" v-bind:key=\"`the_source_indent_${timestampDrawPolygon}`\">\r\n                <vl-source-vector ident=\"the-source\" :features.sync=\"featuresNewPolygon\"></vl-source-vector>\r\n                <vl-style-box>\r\n                    <vl-style-stroke color=\"green\"></vl-style-stroke>\r\n                    <vl-style-fill color=\"rgba(255,255,255,0.5)\"></vl-style-fill>\r\n                </vl-style-box>\r\n            </vl-layer-vector>\r\n\r\n            <vl-interaction-draw v-bind:key=\"`the_source_${timestampDrawPolygon}`\" type=\"Polygon\" source=\"the-source\" v-if=\"!verCrearParcel && !verCrearParcelDraw\" @drawend=\"terminadoNewPolygon\"></vl-interaction-draw>\r\n\r\n            <vl-feature v-if=\"!olcultarInconoUbi\">\r\n                <vl-geom-point :coordinates.sync=\"coordenadasPunto\"></vl-geom-point>\r\n                <vl-style-box>\r\n                    <vl-style-icon src=\"https://d4smartfarming.smartbits-es.com/imgMail/icono-mapa.png\"></vl-style-icon>\r\n                </vl-style-box>\r\n            </vl-feature>\r\n            \r\n            <vl-layer-tile id=\"bingmaps\">\r\n                <vl-source-bingmaps :api-key=\"apiKeyBing\" :imagery-set=\"imagerySetBing\" :maxZoom=\"maxZoomBing\"></vl-source-bingmaps>\r\n            </vl-layer-tile>\r\n            \r\n        </vl-map>\r\n        \r\n        <template v-if=\"flagIndicatingDataHasBeenLoadedInVariables\">\r\n            <ControllerPanel\r\n                v-if=\"!isMobile()\"\r\n                :username=\"name\" \r\n                :arr-enterprises=\"arrEmpresas4List\"\r\n                :arr-cooperativas=\"arrCooperativas\"\r\n                :is_superuser=\"is_superuser\"\r\n                :is_systemadmin=\"is_systemadmin\"\r\n                :is_staff=\"is_staff\"\r\n                :is_enterpriseadmin=\"is_enterpriseadmin\"\r\n                :is_coop_user=\"is_coop_user\"\r\n                :checked-toggle-mostar-texto=\"checkedToggleMostarTexto\"\r\n                :layers-selector=\"layersSelector\"\r\n                :map-component=\"$refs.map.$map\"\r\n                :all-parcels-of-enterprises=\"allParcelsOfEnterprises\"\r\n                :all-parcels-of-enterprises-filter=\"allParcelsOfEnterprisesFilter\"\r\n                :sentinel-layer=\"SentinelLayer\"\r\n\r\n                v-on:setCenter=\"center = $event\"  \r\n                v-on:setCenterLocation=\"coordenadasPunto = $event\"  \r\n                v-on:setToggleMostrarTexto=\"checkedToggleMostarTexto = $event, getNow()\"\r\n                v-on:setEnterprise=\"arrEmpresas = $event, getNow(), arrEmpresas4List = $event\"\r\n                v-on:setSentinelLayer=\"getNowSentinel(), SentinelLayer = $event\"\r\n                v-on:setSentinelClearCache=\"getNowSentinel()\"\r\n                v-on:setSentinelOpacity=\"opacitylayer = $event\"\r\n                v-on:setFechaSentinel=\"time = $event\"\r\n                v-on:setAllParcelsOfEnterprises=\"allParcelsOfEnterprises = $event, allParcelsOfEnterprisesFilter = $event\"\r\n                v-on:setAllParcelsOfEnterprisesFilter=\"allParcelsOfEnterprisesFilter = $event\"\r\n                v-on:setOcultarInconoUbi=\"olcultarInconoUbi = $event\"\r\n            />\r\n            <ControllerPanel4Mobile\r\n                v-if=\"isMobile()\"\r\n                :username=\"name\" \r\n                :arr-enterprises=\"arrEmpresas4List\"\r\n                :arr-cooperativas=\"arrCooperativas\"\r\n                :is_superuser=\"is_superuser\"\r\n                :is_systemadmin=\"is_systemadmin\"\r\n                :checked-toggle-mostar-texto=\"checkedToggleMostarTexto\"\r\n                :layers-selector=\"layersSelector\"\r\n                :map-component=\"$refs.map.$map\"\r\n                :all-parcels-of-enterprises=\"allParcelsOfEnterprises\"\r\n                :all-parcels-of-enterprises-filter=\"allParcelsOfEnterprisesFilter\"\r\n                :sentinel-layer=\"SentinelLayer\"\r\n\r\n                v-on:setCenter=\"center = $event\"  \r\n                v-on:setToggleMostrarTexto=\"checkedToggleMostarTexto = $event, getNow()\"\r\n                v-on:setEnterprise=\"arrEmpresas = $event, getNow(), arrEmpresas4List = $event\"\r\n                v-on:setSentinelLayer=\"getNowSentinel(), SentinelLayer = $event\"\r\n                v-on:setSentinelClearCache=\"getNowSentinel()\"\r\n                v-on:setSentinelOpacity=\"opacitylayer = $event\"\r\n                v-on:setFechaSentinel=\"time = $event\"\r\n                v-on:setAllParcelsOfEnterprises=\"allParcelsOfEnterprises = $event, allParcelsOfEnterprisesFilter = $event\"\r\n                v-on:setAllParcelsOfEnterprisesFilter=\"allParcelsOfEnterprisesFilter = $event\"\r\n            />\r\n            <ControllerQuickEdit \r\n                v-if=\"ifQuickEdit && !is_coop_user && !is_staff\"\r\n                :parcel-selected=\"parcelSelected\"\r\n                :error-draw-msg=\"errorDrawMsg\"\r\n                :ver-error-draw=\"verErrorDraw\"\r\n                :coordinates-poly=\"coordinatesPoly\"\r\n                :value-name=\"valueName\"\r\n                :value-desc=\"valueDesc\"\r\n                :arr-enterprises=\"arrEmpresas\"\r\n                :arr-cooperativas=\"arrCooperativas\"\r\n                :area-for-new-polygon=\"areaForNewPolygon\"\r\n\r\n                v-on:setcoordinatesPoly=\"coordinatesPoly = $event, featuresNewPolygon = []\"\r\n                v-on:setifQuickEdit=\"ifQuickEdit = $event\"\r\n                v-on:setverErrorDraw=\"verErrorDraw = $event\"\r\n                v-on:setSentinelClearCache=\"getNowSentinel()\"\r\n                v-on:setClearParcels=\"getNow()\"\r\n                v-on:setEnterprise=\"arrEmpresas = $event, getNow(), arrEmpresas4List = $event\"\r\n                v-on:setAllParcelsOfEnterprises=\"allParcelsOfEnterprises = $event, allParcelsOfEnterprisesFilter = $event\"\r\n\r\n            />\r\n            <ControllerGoogleSearch\r\n                v-on:setCenter=\"center = $event, coordenadasPunto = $event\"  \r\n            />\r\n            \r\n            <ControllerQuickCreate \r\n                v-if=\"!ifQuickEdit && !is_coop_user && !is_staff\"\r\n                :ver-crear-parcel=\"verCrearParcel\"\r\n                :error-draw-msg=\"errorDrawMsg\"\r\n                :ver-error-draw=\"verErrorDraw\"\r\n                :coordinates-poly=\"coordinatesPoly\"\r\n                :arr-enterprises=\"arrEmpresas4List\"\r\n                :arr-enterprises-selected=\"empresaSelForCreateParcel ? empresaSelForCreateParcel : arrEmpresas\"\r\n                :arr-cooperativas=\"arrCooperativas\"\r\n                :is_superuser=\"is_superuser\"\r\n                :is_systemadmin=\"is_systemadmin\"\r\n                :area-for-new-polygon=\"areaForNewPolygon\"\r\n                :user=\"user\"\r\n\r\n                v-on:setVerCrearParcel=\"verCrearParcel = $event\"\r\n                v-on:setverErrorDraw=\"verErrorDraw = $event\"\r\n                v-on:setEnterpriseSelect=\"empresaSelForCreateParcel = $event\"\r\n                v-on:setClearFeatures=\"featuresNewPolygon = []\"\r\n                v-on:setVerCrearParcelDraw=\"verCrearParcelDraw = $event\"\r\n                v-on:clearCacheDraw=\"getNowRefreshDrawPolygon()\"\r\n                v-on:setSentinelClearCache=\"getNowSentinel()\"\r\n                v-on:setcoordinatesPoly=\"coordinatesPoly = $event, featuresNewPolygon = []\"\r\n                v-on:setEnterprise=\"arrEmpresas = $event, getNow(), arrEmpresas4List = $event\"\r\n                v-on:setAllParcelsOfEnterprises=\"allParcelsOfEnterprises = $event, allParcelsOfEnterprisesFilter = $event\"\r\n            />\r\n        </template>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {getProfile, getPermisos} from '@/auth/index'\r\nimport {getAllEnterprises, getLayersFromSentinel, getEnterprise} from '@/crudFunctions/crudEnterprise'//getEnterprise\r\nimport {getAllCooperatives, getCooperative} from '@/crudFunctions/crudCooperativas'\r\nimport ControllerPanel from '@/components/mapController/ControllerPanel.vue'\r\nimport ControllerPanel4Mobile from '@/components/mapController/ControllerPanel4Mobile.vue'\r\nimport ControllerQuickEdit from '@/components/mapController/ControllerQuickEdit.vue'\r\nimport ControllerGoogleSearch from '@/components/mapController/ControllerGoogleSearch.vue'\r\nimport ControllerQuickCreate from '@/components/mapController/ControllerQuickCreate.vue'\r\nimport {checkValidPolygon} from '@/crudFunctions/crudEnterprise'\r\nimport proj4 from 'proj4'\r\nimport Style from 'ol/style/Style'\r\nimport Text from 'ol/style/Text'\r\nimport Fill from 'ol/style/Fill'\r\nimport Stroke from 'ol/style/Stroke'\r\nimport L from 'leaflet'\r\nimport { getArea } from 'ol/sphere';\r\nimport axios from 'axios'\r\n//import Polygon from 'ol/geom/Polygon'\r\nexport default {\r\n    name: 'MapComponent4',\r\n    components: {ControllerPanel, ControllerQuickEdit, ControllerGoogleSearch,ControllerPanel4Mobile, ControllerQuickCreate\r\n    },\r\n    data() {\r\n        return {\r\n            flagIndicatingDataHasBeenLoadedInVariables: false,\r\n            //Usuario\r\n            is_superuser: false,\r\n            is_staff: false,\r\n            is_systemadmin: false,\r\n            is_enterpriseadmin: false,\r\n            is_coop_user: false,\r\n            //BingMap\r\n            apiKeyBing: this.$apiKeyBing,\r\n            imagerySetBing: `AerialWithLabels`,\r\n            zoom: 15,\r\n            center: [-3.8225970954841486, 40.28385074244977 ],\r\n            maxZoomBing: 20,\r\n            isActiveLoading: false,\r\n            isVisibleLoad: false,\r\n            name: 'pruebas',\r\n            //Parcelas\r\n            parcelas: {},\r\n            //Empresas sel\r\n            arrEmpresas: [],\r\n            arrCooperativas: [],\r\n            arrEmpresas4List: [],\r\n            //Sentinel layer tile controller\r\n            urlSentinel: `${this.$sentinelURL}/ogc/wms/`,\r\n            minZoom:6,\r\n            maxZoom:16,\r\n            preset:'AGRICULTURE',\r\n            layers:'AGRICULTURE',\r\n            time:`2019-01-01/${this.getNow()}`,\r\n            serverType: 'geoserver',\r\n            opacitylayer: 0.5,\r\n            transition: 0,\r\n            SentinelLayer: 'AGRICULTURE',\r\n            timestamp: 0,\r\n            timestampSentinel: 0,\r\n            timestampDrawPolygon: 0,\r\n            checkedToggleMostarTexto: false,\r\n            layersSelector: [],\r\n            //ModificarParcela\r\n            keyModificar: 0,\r\n            allParcelsOfEnterprises: [],\r\n            allParcelsOfEnterprisesFilter: [],\r\n            //if\r\n            ifQuickEdit: false,\r\n            //\r\n            parcelSelected: Object,\r\n            verErrorDraw: false,\r\n            errorDrawMsg: '',\r\n            coordinatesPoly: '',\r\n            //Crear Parcela\r\n            featuresNewPolygon: [],\r\n            verCrearParcel: true,\r\n            verCrearParcelDraw: false,\r\n            empresaSelForCreateParcel: '',\r\n            refreshDibujo: 0,\r\n            //editarParcel\r\n            valueDesc: '',\r\n            valueName: '',\r\n            areaForNewPolygon: 0,\r\n            //\r\n            user: '',\r\n            coordenadasPunto: [0, 0],\r\n            olcultarInconoUbi: false\r\n        }\r\n    },\r\n    methods: {\r\n        isMobile() {\r\n            if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\r\n                return true\r\n            } else {\r\n                return false\r\n            }\r\n        },\r\n        getNowSentinel() {\r\n            const today = new Date();\r\n            const date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n            const time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n            const dateTime = date +' '+ time;\r\n            this.timestampSentinel = dateTime;\r\n        },\r\n        getNowRefreshDrawPolygon() {\r\n            const today = new Date();\r\n            const date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n            const time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n            const dateTime = date +' '+ time;\r\n            this.timestampDrawPolygon = dateTime;\r\n        },\r\n        getNow() {\r\n            const today = new Date();\r\n            const date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n            const time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n            const dateTime = date +' '+ time;\r\n            this.timestamp = dateTime;\r\n        },\r\n        pointsStyleFunc(){\r\n            return feature => {\r\n                let baseStyle = new Style({\r\n                    fill: new Fill({\r\n                        color: \"rgba(255,255,255,0.0)\",\r\n                    }),\r\n                    stroke: new Stroke({\r\n                        color: \"rgba(0, 0, 255, 1)\",\r\n                        with: 5\r\n                    }),\r\n                    text: new Text({\r\n                        overflow: this.checkedToggleMostarTexto,\r\n                        text: `${feature.get('name')} \\n ${feature.get('description') ? feature.get('description') : ''} \\n ${feature.get('area') ? feature.get('area').toFixed(2)+'Ha' : '' } / ${feature.get('area') ? this.metricaparcela(feature.get('area'))+'Acre' : '' }`,\r\n                        font: \"14px IBM Plex Sans\",\r\n                        fill: new Fill({\r\n                            //color: \"#161616\",\r\n                            color: \"#FFFFFF\",\r\n                        }),\r\n                        stroke: new Stroke({\r\n                            color: \"#161616\",\r\n                            width: 4.5\r\n                        }),\r\n                    }),\r\n                })\r\n                return [\r\n                    baseStyle,\r\n                ]\r\n            }\r\n        },\r\n        metricaparcela(area){\r\n            const onehecttoAcre = 2.4710538146717\r\n            const acre = onehecttoAcre * area\r\n            this.metric = \"Acre\"\r\n            return  acre.toFixed(2)\r\n        \r\n        },\r\n\r\n        selecionaPolygon(po){\r\n            this.ifQuickEdit = true\r\n            this.coordinatesPoly = ''\r\n            this.verErrorDraw = true\r\n            this.verErrorDraw = true\r\n            const result = this.allParcelsOfEnterprises.filter(parcel => parcel.id == po.id_)\r\n            this.parcelSelected = result[0]\r\n            const coordenadasGeometricas = po.getGeometry().getExtent()\r\n            const ex = coordenadasGeometricas[0] + (coordenadasGeometricas[2]-coordenadasGeometricas[0])/2;\r\n            const ye = coordenadasGeometricas[1] + (coordenadasGeometricas[3]-coordenadasGeometricas[1])/2;\r\n            var source = new proj4.Proj('EPSG:3785'); \r\n            var dest = new proj4.Proj('EPSG:4326');  \r\n            const newCenter = proj4(source, dest, [ex, ye])\r\n            this.center = [newCenter[0], newCenter[1]]\r\n            const enterprise_id = po.values_.enterprise_id\r\n            this.valueName = po.values_.name\r\n            this.valueDesc = po.values_.description\r\n            this.comprobarCoordenadas(po.getGeometry().getCoordinates(), enterprise_id, po.id_)\r\n        },\r\n        terminadoNewPolygon(p){\r\n            console.info(p)\r\n            this.verCrearParcelDraw = true\r\n            this.areaForNewPolygon = (Math.round((getArea(p.feature.getGeometry())/ 10000) * 10000) / 10000)\r\n            const coordinatesEditadas = p.feature.getGeometry().getCoordinates()\r\n            this.comprobarCoordenadas(coordinatesEditadas, (this.empresaSelForCreateParcel ? this.empresaSelForCreateParcel[0].id : this.arrEmpresas[0].id), 0)\r\n        },\r\n        editado(p){\r\n            const enterprise_id = p.features.array_[0].values_.enterprise_id\r\n            const coordinatesEditadas = p.features.array_[0].getGeometry().getCoordinates()\r\n            this.areaForNewPolygon = (Math.round((getArea(p.features.array_[0].getGeometry())/ 10000) * 10000) / 10000)\r\n            //const area = (Math.round((getArea(p.features.array_[0].getGeometry()) / 10000) * 10000) / 10000)\r\n            this.comprobarCoordenadas(coordinatesEditadas, enterprise_id, p.features.array_[0].id_)\r\n            //if(this.parcelaSeleccionada){\r\n                //this.coordinatesBuenas(this.coordinatesEditadas)\r\n            //}\r\n            \r\n            //this.verErrorDraw = false\r\n        },\r\n        getBBOX(parcel){\r\n            const polygon = L.polygon(parcel.geometry.coordinates)\r\n\r\n            const bboxP = `${polygon.getBounds()._northEast.lng},${polygon.getBounds()._northEast.lat},${polygon.getBounds()._southWest.lng},${polygon.getBounds()._southWest.lat}`\r\n            return bboxP\r\n        },\r\n        getBBOX2(parcel){\r\n            const polygon = L.polygon(parcel.geometry.coordinates)\r\n\r\n            const bboxP = [polygon.getBounds()._northEast.lng,polygon.getBounds()._northEast.lat,polygon.getBounds()._southWest.lng,polygon.getBounds()._southWest.lat]\r\n            return bboxP\r\n        },\r\n        comprobarCoordenadas(coords, enterprise, idParcela){\r\n            var source = new proj4.Proj('EPSG:3785'); \r\n            var dest = new proj4.Proj('EPSG:4326'); \r\n            let newCenter = Array;\r\n            let polygonObject= 'POLYGON(('\r\n            for (var i = 0; i < coords[0].length; i++) {\r\n                newCenter = proj4(source, dest, [coords[0][i][0], coords[0][i][1]])\r\n                polygonObject += newCenter[0]+' '+newCenter[1]\r\n                if(i != (coords[0].length-1)){\r\n                    polygonObject += ', '\r\n                }\r\n            }\r\n            polygonObject += '))';\r\n\r\n            checkValidPolygon(polygonObject, enterprise)\r\n            .then(response => {\r\n                if(response.data.features.length){\r\n                    const result = response.data.features.filter(feature => {\r\n                        if(feature.id != idParcela){\r\n                            return feature\r\n                        }\r\n                    })\r\n                    if(result.length){\r\n                        let parcelsName = ''\r\n                        result.map(resultado => {\r\n                            parcelsName += resultado.properties.name + ' '\r\n                        })\r\n                        this.errorDrawMsg = this.$t('map.parcela_solapada_con') + '' + parcelsName\r\n                        this.verErrorDraw = true\r\n                        this.coordinatesPoly = ''\r\n                    }else{\r\n                        this.verErrorDraw = false\r\n                        this.errorDrawMsg = ''\r\n                        this.coordinatesPoly = polygonObject\r\n                        this.compruebaParcelaSimple(polygonObject)\r\n                    }\r\n                }else{\r\n                    this.verErrorDraw = false\r\n                    this.errorDrawMsg = ''\r\n                    this.coordinatesPoly = polygonObject\r\n                    this.compruebaParcelaSimple(polygonObject)\r\n                }\r\n            })\r\n        },\r\n        compruebaParcelaSimple(polygonObject){\r\n            let path = `${this.$apiURL}/parcel_valid/?polygon=${polygonObject}`;\r\n            axios.defaults.headers.common['Authorization'] = \"Bearer \"+sessionStorage.getItem(\"apiAccess\")\r\n            axios\r\n            .get(path)\r\n            .then(response=>{\r\n                if(response.data == \"False\"){\r\n                    this.errorDrawMsg = this.$t('map.parcela_solapada_misma')\r\n                    this.verErrorDraw = true\r\n                }else{\r\n                    this.verErrorDraw = false\r\n                    this.errorDrawMsg = ''\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.warn(error)\r\n            })\r\n        },\r\n    },\r\n    mounted: function () {\r\n        \r\n        //console.info('User Logged')\r\n    },\r\n    beforeCreate(){\r\n        this.isActiveLoading = false\r\n        this.isVisibleLoad = false\r\n        //* 1 - Obtenemos la info del usuario, a que empresa pertenece y si es administrador\r\n        getProfile()\r\n        .then(response => {\r\n            const user = response.data[0]\r\n            console.info(user)\r\n            this.user = user\r\n            getPermisos(response.data[0].user)\r\n            .then(response => {\r\n                this.is_superuser = response.data.is_superuser\r\n                this.is_staff = response.data.is_staff\r\n                this.is_systemadmin = response.data.is_systemadmin\r\n                this.is_enterpriseadmin = response.data.is_enterpriseadmin\r\n                this.is_coop_user = user.cooperative_user\r\n                /*\r\n                //*Obtenemos la empresa del usuario\r\n                const enterprise_id = user.enterprise_id\r\n                getEnterprise(enterprise_id)\r\n                .then(async response => {\r\n                    this.parcelas = response.data.parcels\r\n                    await this.arrEmpresas.push(response.data)\r\n                    this.flagIndicatingDataHasBeenLoadedInVariables = false\r\n                    this.timestamp()\r\n                })\r\n                */\r\n                \r\n                if(this.is_superuser || this.is_systemadmin){\r\n                    getAllEnterprises()\r\n                    .then(async response => {\r\n                        this.arrEmpresas = [response.data[0]]\r\n                        this.arrEmpresas4List = response.data\r\n                        const arrParcels = []\r\n                        //carga de la primera empresa\r\n                        const empresaFirst = [response.data[0]]\r\n                        //response.data[0].map(enterprise => {\r\n                        empresaFirst.map(enterprise => {\r\n                            enterprise.parcels.features.map(parcel => {\r\n                                arrParcels.push(parcel)\r\n                            })\r\n                        })\r\n                        this.allParcelsOfEnterprises = arrParcels\r\n                        this.allParcelsOfEnterprisesFilter = arrParcels\r\n                        this.flagIndicatingDataHasBeenLoadedInVariables = true\r\n                    })\r\n                }else if((this.is_enterpriseadmin || this.is_staff) && !this.is_coop_user){ \r\n                    getEnterprise(user.enterprise_id)\r\n                    .then(async response => {\r\n                        this.arrEmpresas = [response.data]\r\n                        this.arrEmpresas4List = [response.data]\r\n                        const arrParcels = []\r\n                        response.data.parcels.features.map(parcel => {\r\n                            arrParcels.push(parcel)\r\n                        })\r\n                        this.allParcelsOfEnterprises = arrParcels\r\n                        this.allParcelsOfEnterprisesFilter = arrParcels\r\n                        this.flagIndicatingDataHasBeenLoadedInVariables = true\r\n                    })\r\n                }else if(this.is_coop_user){\r\n                    getCooperative(user.enterprise_id)\r\n                    .then(response => {\r\n                        this.arrCooperativas = [response.data]\r\n                        //this.arrEmpresas = response.data.enterprises\r\n                        this.flagIndicatingDataHasBeenLoadedInVariables = true\r\n                    })\r\n                }\r\n\r\n                if(this.is_superuser || this.is_systemadmin){\r\n                    getAllCooperatives()\r\n                    .then(async response => {\r\n                        this.arrCooperativas = response.data\r\n                    })\r\n                }\r\n                this.isActiveLoading = false\r\n                this.isVisibleLoad = false\r\n            })\r\n        })\r\n        getLayersFromSentinel().then(response => {\r\n            this.layersSelector = response.data\r\n        })\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n    #map{\r\n        width: 100%; height: 100%; position:fixed\r\n    }\r\n    \r\n    .mapa{\r\n        width: 100%; height: 100%!important; position: fixed\r\n    }\r\n    #cargando{\r\n        position:fixed\r\n    }\r\n</style>"]}]}