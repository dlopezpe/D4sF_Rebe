{"version":3,"file":"index.js","sources":["src/component/vector-tile-source/source.vue?rollup-plugin-vue=script.js","src/component/vector-tile-source/source.vue","src/component/vector-tile-source/index.js"],"sourcesContent":["\nimport Feature from 'ol/Feature'\nimport VectorTileSource from 'ol/source/VectorTile'\nimport { observableFromOlEvent } from '../../rx-ext'\nimport { hasSource } from '../../util/assert'\nimport { forEach } from '../../util/minilo'\nimport { tileSource } from '../../mixin'\nimport { createMvtFmt, initializeFeature } from '../../ol-ext'\n\nexport default {\n  name: 'vl-source-vector-tile',\n  mixins: [tileSource],\n  props: {\n    cacheSize: {\n      type: Number,\n      default: 128,\n    },\n    /**\n     * Source format factory\n     * @type {(function(): Feature|undefined)} formatFactory\n     */\n    formatFactory: {\n      type: Function,\n      default: defaultFormatFactory,\n    },\n    overlaps: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  computed: {\n    dataFormat () {\n      return this.formatFactory()\n    },\n  },\n  methods: {\n    /**\n     * @return {VectorTileSource}\n     */\n    createSource () {\n      return new VectorTileSource({\n        attributions: this.attributions,\n        cacheSize: this.cacheSize,\n        format: this.dataFormat,\n        logo: this.logo,\n        overlaps: this.overlaps,\n        projection: this.projection,\n        tileGrid: this._tileGrid,\n        tileLoadFunction: this.tileLoadFunction,\n        tileUrlFunction: this.urlFunc,\n        wrapX: this.wrapX,\n        transition: this.transition,\n      })\n    },\n    subscribeAll () {\n      this::tileSource.methods.subscribeAll()\n      this::subscribeToSourceEvents()\n    },\n  },\n}\n\n/**\n * @return {TopoJSON}\n */\nfunction defaultFormatFactory () {\n  return createMvtFmt()\n}\n\nfunction subscribeToSourceEvents () {\n  hasSource(this)\n\n  this.subscribeTo(observableFromOlEvent(this.$source, 'tileloadend'), evt => {\n    if (!evt.tile) {\n      return\n    }\n\n    forEach(evt.tile.getFeatures(), feature => {\n      if (!(feature instanceof Feature)) {\n        return\n      }\n      initializeFeature(feature)\n    })\n  })\n}\n","<script>\n  import Feature from 'ol/Feature'\n  import VectorTileSource from 'ol/source/VectorTile'\n  import { observableFromOlEvent } from '../../rx-ext'\n  import { hasSource } from '../../util/assert'\n  import { forEach } from '../../util/minilo'\n  import { tileSource } from '../../mixin'\n  import { createMvtFmt, initializeFeature } from '../../ol-ext'\n\n  export default {\n    name: 'vl-source-vector-tile',\n    mixins: [tileSource],\n    props: {\n      cacheSize: {\n        type: Number,\n        default: 128,\n      },\n      /**\n       * Source format factory\n       * @type {(function(): Feature|undefined)} formatFactory\n       */\n      formatFactory: {\n        type: Function,\n        default: defaultFormatFactory,\n      },\n      overlaps: {\n        type: Boolean,\n        default: true,\n      },\n    },\n    computed: {\n      dataFormat () {\n        return this.formatFactory()\n      },\n    },\n    methods: {\n      /**\n       * @return {VectorTileSource}\n       */\n      createSource () {\n        return new VectorTileSource({\n          attributions: this.attributions,\n          cacheSize: this.cacheSize,\n          format: this.dataFormat,\n          logo: this.logo,\n          overlaps: this.overlaps,\n          projection: this.projection,\n          tileGrid: this._tileGrid,\n          tileLoadFunction: this.tileLoadFunction,\n          tileUrlFunction: this.urlFunc,\n          wrapX: this.wrapX,\n          transition: this.transition,\n        })\n      },\n      subscribeAll () {\n        this::tileSource.methods.subscribeAll()\n        this::subscribeToSourceEvents()\n      },\n    },\n  }\n\n  /**\n   * @return {TopoJSON}\n   */\n  function defaultFormatFactory () {\n    return createMvtFmt()\n  }\n\n  function subscribeToSourceEvents () {\n    hasSource(this)\n\n    this.subscribeTo(observableFromOlEvent(this.$source, 'tileloadend'), evt => {\n      if (!evt.tile) {\n        return\n      }\n\n      forEach(evt.tile.getFeatures(), feature => {\n        if (!(feature instanceof Feature)) {\n          return\n        }\n        initializeFeature(feature)\n      })\n    })\n  }\n</script>\n","import { pick } from '../../util/minilo'\nimport Source from './source.vue'\n\nfunction plugin (Vue, options = {}) {\n  if (plugin.installed) {\n    return\n  }\n  plugin.installed = true\n\n  options = pick(options, 'dataProjection')\n  Object.assign(Source, options)\n\n  Vue.component(Source.name, Source)\n}\n\nexport default plugin\n\nexport {\n  Source,\n  plugin as install,\n}\n"],"names":["name","mixins","tileSource","props","cacheSize","type","Number","default","formatFactory","Function","defaultFormatFactory","overlaps","Boolean","computed","dataFormat","methods","createSource","VectorTileSource","attributions","format","logo","projection","tileGrid","_tileGrid","tileLoadFunction","tileUrlFunction","urlFunc","wrapX","transition","subscribeAll","subscribeToSourceEvents","createMvtFmt","hasSource","subscribeTo","observableFromOlEvent","$source","evt","tile","forEach","getFeatures","feature","Feature","initializeFeature","plugin","Vue","options","installed","pick","Source","component"],"mappings":";;;;;;;;;;;;;;;;;;;;AASA,aAAe;EACbA,IAAI,EAAE,uBADO;EAEbC,MAAM,EAAE,CAACC,UAAD,CAFK;EAGbC,KAAK,EAAE;IACLC,SAAS,EAAE;MACTC,IAAI,EAAEC,MADG;MAETC,OAAO,EAAE;KAHN;;;;;;IASLC,aAAa,EAAE;MACbH,IAAI,EAAEI,QADO;MAEbF,OAAO,EAAEG;KAXN;IAaLC,QAAQ,EAAE;MACRN,IAAI,EAAEO,OADE;MAERL,OAAO,EAAE;;GAlBA;EAqBbM,QAAQ,EAAE;IACRC,UADQ,wBACM;aACL,KAAKN,aAAL,EAAP;;GAvBS;EA0BbO,OAAO,EAAE;;;;IAIPC,YAJO,0BAIS;aACP,IAAIC,gBAAJ,CAAqB;QAC1BC,YAAY,EAAE,KAAKA,YADO;QAE1Bd,SAAS,EAAE,KAAKA,SAFU;QAG1Be,MAAM,EAAE,KAAKL,UAHa;QAI1BM,IAAI,EAAE,KAAKA,IAJe;QAK1BT,QAAQ,EAAE,KAAKA,QALW;QAM1BU,UAAU,EAAE,KAAKA,UANS;QAO1BC,QAAQ,EAAE,KAAKC,SAPW;QAQ1BC,gBAAgB,EAAE,KAAKA,gBARG;QAS1BC,eAAe,EAAE,KAAKC,OATI;QAU1BC,KAAK,EAAE,KAAKA,KAVc;QAW1BC,UAAU,EAAE,KAAKA;OAXZ,CAAP;KALK;IAmBPC,YAnBO,0BAmBS;MACR3B,UAAU,CAACa,OAAX,CAAmBc,YAAzB;MACMC,uBAAN;;;CA/CN;;;;;AAuDA,SAASpB,oBAAT,GAAiC;SACxBqB,YAAY,EAAnB;;;AAGF,SAASD,uBAAT,GAAoC;EAClCE,SAAS,CAAC,IAAD,CAAT;OAEKC,WAAL,CAAiBC,qBAAqB,CAAC,KAAKC,OAAN,EAAe,aAAf,CAAtC,EAAqE,UAAAC,GAAG,EAAI;QACtE,CAACA,GAAG,CAACC,IAAT,EAAe;;;;IAIfC,OAAO,CAACF,GAAG,CAACC,IAAJ,CAASE,WAAT,EAAD,EAAyB,UAAAC,OAAO,EAAI;UACrC,EAAEA,OAAO,YAAYC,OAArB,CAAJ,EAAmC;;;;MAGnCC,iBAAiB,CAACF,OAAD,CAAjB;KAJK,CAAP;GALF;;;ACpEU,2BAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAZ,SAASG,MAAT,CAAiBC,GAAjB,EAAoC;MAAdC,OAAc,uEAAJ,EAAI;;MAC9BF,MAAM,CAACG,SAAX,EAAsB;;;;EAGtBH,MAAM,CAACG,SAAP,GAAmB,IAAnB;EAEAD,OAAO,GAAGE,IAAI,CAACF,OAAD,EAAU,gBAAV,CAAd;;iBACcG,MAAd,EAAsBH,OAAtB;;EAEAD,GAAG,CAACK,SAAJ,CAAcD,MAAM,CAAChD,IAArB,EAA2BgD,MAA3B;;;;;;"}